{
  "hash": "71608e3e2ad3e4c5006d23aff8932e09",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Prática em R\"\nsubtitle: \"Contrastando hipóteses: da formulação de modelos à atualização do conhecimento\"\nauthor: \n  - \"Prof. Fabio Cop (*fcferreira@unifesp.br*)\"\n  - \"Instituto do Mar - Unifesp\"\ndate: today\nlang: pt-BR\nlanguage:\n  title-block-author-single: \"\"\n  title-block-author-plural: \"\"\nformat:\n  html:\n\n    toc: true\n    toc-title: \"Conteúdo\"\n    toc-depth: 2\n    number-sections: true\n    embed-resources: true\n    code-fold: false\n    code-tools: true\n  pdf:\n    documentclass: article\n    papersize: a4\n    geometry:\n      - margin=2.5cm\n    toc: true\n    toc-title: \"Conteúdo\"\n    toc-depth: 2\n    number-sections: true\n    colorlinks: true\n    include-in-header:\n      text: |\n        \\usepackage{authblk}\n---\n\n{{< pagebreak >}}\n\n\n\n\n\n\n\n\n\n\n::: {.callout-note appearance=\"minimal\"}\n**Curso:** Bacharelado Interdisciplinar em Ciências do Mar  \n**Unidade Curricular (UC):** Probabilidade e Estatística  \n**Atividade:** Prática no Laboratório de Informática  \n:::\n\n::: {.callout-important appearance=\"minimal\" title=\"Instruções\"}\n\n1. **Copie e execute o código**\n2. **Observe** os resultados que aparecem\n3. **Responda** às perguntas no documento que você vai entregar\n4. **Entrega:** Acesse o Moodle e adicione suas respostas às perguntas abaixo\n5. **Prazo:** Final da aula de hoje\n:::\n\n# Preparação: Carregando os Dados da Turma\n\nCarregue os dados coletados no início da aula (dado mental e dado físico) para começar a análise.\n\n### *Código* {-}\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Carregar os dados do arquivo CSV\ndados <- read.csv(\"/caminhodoarquivo/dados_turma_aula1.csv\")\n\n# Separar os dados em dois vetores\nmental <- dados$dado_mental\nfisico <- dados$dado_fisico\n\n# Contar quantas observações temos\nn_mental <- length(mental)\nn_fisico <- length(fisico)\n\n# Mostrar os primeiros valores\nprint(\"Primeiras respostas - Dado Mental:\")\nhead(mental, 10)\n\nprint(\"Primeiras respostas - Dado Físico:\")\nhead(fisico, 10)\n\nprint(paste(\"Total de observações (dado mental):\", n_mental))\nprint(paste(\"Total de observações (dado físico):\", n_fisico))\n```\n:::\n\n\n\n\n\n\n::: {.callout-tip appearance=\"minimal\" title=\"O que observar\"}\n\n- O R carregou o arquivo CSV com sucesso.\n- Você vê os primeiros 10 números do dado mental (valores de 1 a 6).\n- Você vê os primeiros 10 números do dado físico (valores de 1 a 6).\n- Aparece o total de observações de cada experimento.\n\n:::\n\n\n# Reproduzindo a Análise da Aula\n\nRealize os seguintes passos: calcular frequências, fazer gráficos e calcular as verossimilhanças de H₀ e H₁.\n\n## Calculando as Frequências\n\n### *Código* {-}\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Contar quantas vezes cada face apareceu\nfreq_mental <- table(factor(mental, levels = 1:6))\nfreq_fisico <- table(factor(fisico, levels = 1:6))\n\n# Mostrar as contagens\nprint(\"Frequências absolutas - Dado Mental:\")\nfreq_mental\n\nprint(\"Frequências absolutas - Dado Físico:\")\nfreq_fisico\n\n# Calcular as proporções (dividir pelo total)\nprop_mental <- freq_mental / n_mental\nprop_fisico <- freq_fisico / n_fisico\n\nprint(\"Proporções - Dado Mental:\")\nround(prop_mental, 3)\n\nprint(\"Proporções - Dado Físico:\")\nround(prop_fisico, 3)\n```\n:::\n\n\n\n\n\n\n::: {.callout-tip appearance=\"minimal\" title=\"O que observar\"}\n\n- As **frequências absolutas** mostram quantas vezes cada face (1, 2, 3, 4, 5, 6) apareceu.\n- As **proporções** mostram a porcentagem de cada face (valores entre 0 e 1).\n- Compare mentalmente: alguma face apareceu muito mais que as outras?\n\n:::\n\n## Visualizando os Dados com Gráficos\n\n### *Código* {-}\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Configurar para mostrar dois gráficos lado a lado\npar(mfrow = c(1, 2))\n\n# Gráfico do dado físico\nbarplot(prop_fisico, \n        col = \"seagreen\", \n        main = \"Dado Físico\",\n        xlab = \"Face\", \n        ylab = \"Proporção\", \n        ylim = c(0, 0.35))\nabline(h = 1/6, lty = 2, col = \"red\", lwd = 2)\n\n# Gráfico do dado mental\nbarplot(prop_mental, \n        col = \"steelblue\", \n        main = \"Dado Mental\",\n        xlab = \"Face\", \n        ylab = \"Proporção\", \n        ylim = c(0, 0.35))\nabline(h = 1/6, lty = 2, col = \"red\", lwd = 2)\n```\n:::\n\n\n\n\n\n\n::: {.callout-tip appearance=\"minimal\" title=\"O que observar\"}\n\n- Você deve ver **dois gráficos de barras** lado a lado.\n- A **linha vermelha tracejada** marca 1/6 = 0.167 (o esperado se o dado fosse uniforme).\n- Compare os dois gráficos: qual deles parece mais próximo da linha vermelha?\n\n:::\n\n::: {.callout-important appearance=\"default\" icon=\"false\"}\n\n### **PERGUNTA 1** {-}\n\nOlhando para os dois gráficos:\n\na) O dado físico parece seguir uma distribuição uniforme (todas as faces com proporção próxima de 1/6)? Justifique.\n\nb) O dado mental parece seguir uma distribuição uniforme? Quais faces aparecem mais ou menos que o esperado?\n\n:::\n\n## Calculando as Verossimilhanças\n\n### *Código* {-}\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Definir as probabilidades de cada modelo\np_h0 <- rep(1/6, 6)  # H₀: todas as faces com prob = 1/6\np_h1 <- c(1, 2, 4, 4, 2, 1) / 14  # H₁: viés central\n\n# Ver as probabilidades de H₁\nprint(\"Probabilidades do modelo H₁:\")\nround(p_h1, 3)\n\n# Calcular log-verossimilhança de H₀ para o dado físico\nloglik_H0_fisico <- sum(freq_fisico * log(p_h0))\n\n# Calcular log-verossimilhança de H₁ para o dado físico\nloglik_H1_fisico <- sum(freq_fisico * log(p_h1))\n\n# Calcular log-verossimilhança de H₀ para o dado mental\nloglik_H0_mental <- sum(freq_mental * log(p_h0))\n\n# Calcular log-verossimilhança de H₁ para o dado mental\nloglik_H1_mental <- sum(freq_mental * log(p_h1))\n\n# Mostrar os resultados\nprint(\"=== DADO FÍSICO ===\")\nprint(paste(\"Log-verossimilhança H₀:\", round(loglik_H0_fisico, 2)))\nprint(paste(\"Log-verossimilhança H₁:\", round(loglik_H1_fisico, 2)))\n\nprint(\"=== DADO MENTAL ===\")\nprint(paste(\"Log-verossimilhança H₀:\", round(loglik_H0_mental, 2)))\nprint(paste(\"Log-verossimilhança H₁:\", round(loglik_H1_mental, 2)))\n```\n:::\n\n\n\n\n\n\n::: {.callout-tip appearance=\"minimal\" title=\"O que observar\"}\n\n- Você vê os valores de log-verossimilhança (números negativos).\n- Valores **menos negativos** = maior verossimilhança = modelo mais compatível com os dados.\n- Compare H₀ vs H₁ para cada experimento.\n\n:::\n\n## Comparando Modelos com Razão de Verossimilhanças\n\n### *Código* {-}\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calcular a razão H₁/H₀ para cada experimento\nrazao_fisico <- exp(loglik_H1_fisico - loglik_H0_fisico)\nrazao_mental <- exp(loglik_H1_mental - loglik_H0_mental)\n\nprint(\"=== RAZÃO DE VEROSSIMILHANÇAS (H₁/H₀) ===\")\nprint(paste(\"Dado Físico:\", round(razao_fisico, 2)))\nprint(paste(\"Dado Mental:\", round(razao_mental, 2)))\n```\n:::\n\n\n\n\n\n\n::: {.callout-tip appearance=\"minimal\" title=\"O que observar\"}\n\n- A **razão de verossimilhanças** compara os dois modelos.\n- Se a razão > 1: H₁ é mais verossímil que H₀.\n- Se a razão < 1: H₀ é mais verossímil que H₁.\n- Quanto maior o número, mais forte é a evidência.\n\n:::\n\n::: {.callout-important appearance=\"default\" icon=\"false\"}\n\n### **PERGUNTA 2** {-}\n\na) Para o dado físico, qual hipótese (H₀ ou H₁) é mais compatível com os dados? Por quê?\n\nb) Para o dado mental, qual hipótese é mais compatível? A diferença é grande?\n\n:::\n\n## Teste a Independência de H₀ dos Dados\n\n### *Código* {-}\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Vamos criar dados fictícios diferentes, mas com o MESMO total\ndados_equilibrados <- c(rep(1, 8), rep(2, 9), rep(3, 8), \n                        rep(4, 9), rep(5, 8), rep(6, 8))\n\ndados_extremos <- c(rep(1, 25), rep(2, 0), rep(3, 0), \n                    rep(4, 0), rep(5, 0), rep(6, 25))\n\n# Ambos têm n = 50 observações\nn_teste <- 50\n\n# Calcular verossimilhança de H₀ para os dois casos\nfreq_eq <- table(factor(dados_equilibrados, levels = 1:6))\nfreq_ex <- table(factor(dados_extremos, levels = 1:6))\n\nloglik_H0_equilibrado <- sum(freq_eq * log(p_h0))\nloglik_H0_extremo <- sum(freq_ex * log(p_h0))\n\nprint(\"=== TESTE: H₀ É CEGO AO PADRÃO? ===\")\nprint(paste(\"H₀ para dados equilibrados:\", round(loglik_H0_equilibrado, 2)))\nprint(paste(\"H₀ para dados extremos:\", round(loglik_H0_extremo, 2)))\nprint(paste(\"São iguais?\", \n            round(loglik_H0_equilibrado, 2) == round(loglik_H0_extremo, 2)))\n```\n:::\n\n\n\n\n\n\n::: {.callout-tip appearance=\"minimal\" title=\"O que observar\"}\n\n- Os dois conjuntos de dados são **completamente diferentes**.\n- Mas a verossimilhança de H₀ é **exatamente a mesma**.\n- Isso confirma que H₀ só depende do total de observações, não do padrão.\n\n:::\n\n::: {.callout-important appearance=\"default\" icon=\"false\"}\n\n### **PERGUNTA 3** {-}\n\nCom base neste teste, explique por que precisamos de pelo menos **duas hipóteses** para avaliar modelos. O que aconteceria se só tivéssemos H₀?\n\n:::\n\n# Simular e Calibrar\n\nSimule 1000 \"turmas virtuais\" sob H₀ e verifique onde nossos dados reais se encaixam nessa distribuição de simulações.\n\n## Simulando sob H₀\n\n### *Código* {-}\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Número de simulações\nn_sim <- 1000\n\n# Vetor para guardar as razões de verossimilhança\nrazoes_simuladas <- numeric(n_sim)\n\n# Loop: para cada simulação...\nfor (i in 1:n_sim) {\n  # Simular uma turma sob H₀ (dado justo)\n  amostra_sim <- sample(1:6, n_mental, replace = TRUE, prob = p_h0)\n  \n  # Calcular frequências\n  freq_sim <- table(factor(amostra_sim, levels = 1:6))\n  \n  # Calcular log-verossimilhanças\n  loglik_H0_sim <- sum(freq_sim * log(p_h0))\n  loglik_H1_sim <- sum(freq_sim * log(p_h1))\n  \n  # Guardar a razão\n  razoes_simuladas[i] <- exp(loglik_H1_sim - loglik_H0_sim)\n}\n\nprint(\"Simulação concluída!\")\nprint(paste(\"Média das razões simuladas:\", round(mean(razoes_simuladas), 2)))\nprint(paste(\"Desvio padrão:\", round(sd(razoes_simuladas), 2)))\n```\n:::\n\n\n\n\n\n\n::: {.callout-tip appearance=\"minimal\" title=\"O que observar\"}\n\n- O R simulou 1000 turmas onde **todos** os dados vêm de um dado justo (H₀).\n- Para cada turma simulada, calculamos a razão H₁/H₀.\n- A média nos diz qual razão é \"típica\" quando H₀ é verdadeiro.\n\n:::\n\n## Visualizando as Simulações\n\n### *Código* {-}\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fazer o histograma das razões simuladas\nhist(razoes_simuladas, \n     breaks = 30, \n     col = \"lightblue\", \n     main = \"Distribuição de H₁/H₀ sob simulações de H₀\",\n     xlab = \"Razão de Verossimilhança (H₁/H₀)\",\n     ylab = \"Frequência\")\n\n# Marcar onde caiu o dado físico\nabline(v = razao_fisico, col = \"green\", lwd = 3, lty = 2)\ntext(razao_fisico, 100, \"Dado Físico\", pos = 4, col = \"green\")\n\n# Marcar onde caiu o dado mental\nabline(v = razao_mental, col = \"red\", lwd = 3, lty = 2)\ntext(razao_mental, 120, \"Dado Mental\", pos = 4, col = \"red\")\n\n# Marcar a linha de 1 (onde H₀ e H₁ têm mesma verossimilhança)\nabline(v = 1, col = \"black\", lwd = 2)\n```\n:::\n\n\n\n\n\n\n::: {.callout-tip appearance=\"minimal\" title=\"O que observar\"}\n\n- O **histograma azul** mostra as razões quando geramos dados de um dado justo.\n- A **linha verde** marca onde caiu o dado físico da nossa turma.\n- A **linha vermelha** marca onde caiu o dado mental da nossa turma.\n- A **linha preta** marca razão = 1 (empate entre H₀ e H₁).\n\n:::\n\n::: {.callout-important appearance=\"default\" icon=\"false\"}\n\n### **PERGUNTA 4** {-}\n\na) O valor do dado físico está dentro da região típica das simulações sob H₀? O que isso significa?\n\nb) O valor do dado mental está dentro ou fora da região típica? O que isso indica sobre a necessidade de H₁?\n\nc) Baseado neste histograma, você diria que os dados do dado mental foram gerados por um processo uniforme (H₀)?\n\n:::\n\n# Modelos a Priori\n\nExplore como diferentes crenças iniciais (prioris) afetam a conclusão final (posteriori).\n\n## A Priori da Turma\n\n### *Código* {-}\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Inserir os valores REAIS da votação da turma\n# (substituir pelos números do quadro)\nn_turma <- 50\nvotos_H0 <- 32  # Quantos votaram em H₀\nvotos_H1 <- 18  # Quantos votaram em H₁\n\n# Calcular a priori\nprior_turma <- c(H0 = votos_H0 / n_turma, H1 = votos_H1 / n_turma)\n\nprint(\"Priori da Turma:\")\nround(prior_turma, 2)\n```\n:::\n\n\n\n\n\n\n## Calculando a Posteriori com Diferentes Prioris\n\n### *Código* {-}\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Função auxiliar para calcular posteriori\ncalcular_posteriori <- function(prior, loglik_H0, loglik_H1) {\n  lik <- c(H0 = exp(loglik_H0), H1 = exp(loglik_H1))\n  post <- prior * lik\n  post <- post / sum(post)\n  return(post)\n}\n\n# Posteriori com priori da turma\npost_turma_mental <- calcular_posteriori(prior_turma, \n                                         loglik_H0_mental, \n                                         loglik_H1_mental)\n\n# Posteriori com priori 50/50 (sem preferência)\nprior_neutro <- c(H0 = 0.5, H1 = 0.5)\npost_neutro_mental <- calcular_posteriori(prior_neutro, \n                                          loglik_H0_mental, \n                                          loglik_H1_mental)\n\n# Posteriori com priori 90/10 (forte preferência por H₀)\nprior_forte_H0 <- c(H0 = 0.9, H1 = 0.1)\npost_forte_H0_mental <- calcular_posteriori(prior_forte_H0, \n                                            loglik_H0_mental, \n                                            loglik_H1_mental)\n\n# Posteriori com priori 10/90 (forte preferência por H₁)\nprior_forte_H1 <- c(H0 = 0.1, H1 = 0.9)\npost_forte_H1_mental <- calcular_posteriori(prior_forte_H1, \n                                            loglik_H0_mental, \n                                            loglik_H1_mental)\n\n# Mostrar resultados\nprint(\"=== PRIORI DA TURMA ===\")\nprint(round(prior_turma, 3))\nprint(\"Posteriori:\")\nprint(round(post_turma_mental, 3))\n\nprint(\"=== PRIORI NEUTRO (50/50) ===\")\nprint(round(prior_neutro, 3))\nprint(\"Posteriori:\")\nprint(round(post_neutro_mental, 3))\n\nprint(\"=== PRIORI FORTE EM H₀ (90/10) ===\")\nprint(round(prior_forte_H0, 3))\nprint(\"Posteriori:\")\nprint(round(post_forte_H0_mental, 3))\n\nprint(\"=== PRIORI FORTE EM H₁ (10/90) ===\")\nprint(round(prior_forte_H1, 3))\nprint(\"Posteriori:\")\nprint(round(post_forte_H1_mental, 3))\n```\n:::\n\n\n\n\n\n\n## Visualizando a Atualização Bayesiana\n\n### *Código* {-}\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Criar uma figura com 4 painéis\npar(mfrow = c(2, 2))\n\n# Painel 1: Priori e Posteriori da Turma\nbarplot(rbind(prior_turma, post_turma_mental), \n        beside = TRUE, \n        col = c(\"grey70\", \"salmon\"),\n        main = \"Priori da Turma\",\n        ylab = \"Probabilidade\",\n        ylim = c(0, 1),\n        legend.text = c(\"Priori\", \"Posteriori\"))\n\n# Painel 2: Priori e Posteriori Neutro\nbarplot(rbind(prior_neutro, post_neutro_mental), \n        beside = TRUE, \n        col = c(\"grey70\", \"salmon\"),\n        main = \"Priori Neutro (50/50)\",\n        ylab = \"Probabilidade\",\n        ylim = c(0, 1),\n        legend.text = c(\"Priori\", \"Posteriori\"))\n\n# Painel 3: Priori e Posteriori Forte em H₀\nbarplot(rbind(prior_forte_H0, post_forte_H0_mental), \n        beside = TRUE, \n        col = c(\"grey70\", \"salmon\"),\n        main = \"Priori Forte em H₀ (90/10)\",\n        ylab = \"Probabilidade\",\n        ylim = c(0, 1),\n        legend.text = c(\"Priori\", \"Posteriori\"))\n\n# Painel 4: Priori e Posteriori Forte em H₁\nbarplot(rbind(prior_forte_H1, post_forte_H1_mental), \n        beside = TRUE, \n        col = c(\"grey70\", \"salmon\"),\n        main = \"Priori Forte em H₁ (10/90)\",\n        ylab = \"Probabilidade\",\n        ylim = c(0, 1),\n        legend.text = c(\"Priori\", \"Posteriori\"))\n```\n:::\n\n\n\n\n\n\n::: {.callout-tip appearance=\"minimal\" title=\"O que observar\"}\n\n- Quatro gráficos mostrando como diferentes prioris levam a diferentes posterioris.\n- Em cada gráfico, as barras cinzas são a **priori** (antes dos dados).\n- As barras salmão são a **posteriori** (depois dos dados).\n- Observe como a evidência dos dados \"puxa\" a crença em direção a H₁.\n\n:::\n\n\n::: {.callout-important appearance=\"default\" icon=\"false\"}\n\n### **PERGUNTA 5** {-}\n\na) Em qual dos quatro cenários a priori teve **maior** influência na posteriori? Por quê?\n\nb) Em qual cenário a priori teve **menor** influência? O que isso nos ensina sobre quando a priori importa mais ou menos?\n\nc) Mesmo com uma priori muito forte em H₀ (90/10), a posteriori mudou em direção a H₁? O que isso indica sobre a força da evidência nos dados do dado mental?\n\n:::\n\n# Recapitulando as Etapas de Hoje\n\nConceitos fundamentais da inferência estatística/probabilística:\n\n1. **Modelos probabilísticos**: Traduzir hipóteses em equações matemáticas com probabilidades.\n2. **Verossimilhança**: Medir quão compatível um modelo é com os dados observados.\n3. **Comparação de modelos**: Comparar a verossimilhança entre os modelos.\n4. **Simulação**: Gerar dados para entender o que cada modelo pode prever.\n5. **Inferência Bayesiana**: Atualizar as crenças combinando conhecimento prévio (priori) com evidências (dados).",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}